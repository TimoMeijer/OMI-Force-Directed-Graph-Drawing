<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>OMI</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="https://rawgit.com/eligrey/FileSaver.js/master/FileSaver.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-signals/1.0.0/js-signals.js"></script>
    <script src="omi.js"></script>

    <style>
        .node {
            stroke: #fff;
            stroke-width: 2px;
        }

        .link {
            stroke: #999;
            stroke-opacity: 0.8;
            stroke-width: 3px;
        }
    </style>

    <script>
        $(document).ready(function() {
            'use strict';

            var running = false;

            $('#run').on('click', function() {
                if (!running) {
                    running = true;

                    var research = new omi.Research({
                        linkStrengths: [0.1, 1.0]/*[0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]*/, // linkStrengths to be tested
                        charges: [1, -1000]/*[0, -10, -20, -30, -40, -50, -60, -70, -80, -90, -100]*/, // charges to be tested
                        graphs: [[20,24]]/*[[20,24], [20,70], [20,170], [100, 120], [100, 1000], [100, 10000]]*/, // graphs to be tested, defined as [vertexCount, edgeCount]
                        graphRepeat: 1/*3*/, // How many different graphs will be tested for each combination of vertex/edges
                        repeat: 1/*100*/, // How many times each configuration will be tested
                        metrics: omi.metric, // Metric functions to be used to process the generated graphs
                        wolframUrl: $('#wolframUrl').val(), // The Wolfram API URL where graphs can be fetched from
                        visual: true, // If a visual interface should be selector
                        selector: '#omi', // Element where the visual interface will be rendered in
                        width: 960, // Width of the test area for the algorithm
                        height: 500, // height of the test area for the algorithm
                        scale: 1, // Scale to display the interface on a different scale than the test area
                        seed: 0 // Seed to be used for the random generation of graphs
                    });
                    var progress = new omi.ProgressBar($('#researchProgress'), research.numTests);

                    research.testFinished.add(function() {
                        progress.add(1);
                    });

                    research.start().done(function(results) {
                        var csvResults = omi.resultsToCsv(results);

                        var blob = new Blob([csvResults], {type: "text/csv;charset=utf-8"});
                        saveAs(blob, "omiResults."+ $.now()+".csv");
                    });
                }
            });
        });
    </script>
</head>
<body>
    <main class="container">
        <div class="row" style="margin-top:5px;">
            <div class="col-xs-12">
                <form class="form-inline">
                    <div class="form-group">
                        <input type="url" class="form-control" id="wolframUrl" placeholder="Enter Wolfram API URL">
                    </div>
                    <button type="button" class="btn btn-primary" id="run">Run Tests</button>
                </form>
            </div>
        </div>
        <div class="row" style="margin-top:5px;">
            <div class="col-xs-12">
                <div class="progress">
                    <div id="researchProgress" class="progress-bar" role="progressbar"></div>
                </div>
            </div>
        </div>
        <div class="row" style="margin-top:5px;">
            <div class="col-xs-12" id="omi"></div>
        </div>
    </main>
</body>
</html>
